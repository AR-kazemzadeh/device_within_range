{"mappings":"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","sources":["script.js"],"sourcesContent":["//import * as my_dongle from 'bleuio'\r\ndocument.getElementById('connect').addEventListener('click', function(){\r\n  my_dongle.at_connect()\r\n})\r\n\r\n/*\r\nFunctions to converts rssi to distance \r\nread more at \r\nhttps://iotandelectronics.wordpress.com/2016/10/07/how-to-calculate-distance-from-the-rssi-value-of-the-ble-beacon/\r\n*/\r\nconst getDistance =((rssi)=>{\r\n  let n=2\r\n  let mp=-69\r\n  let theDistance =  10 ** ((mp - (rssi))/(10 * n))\r\n  return theDistance\r\n})\r\ndocument.getElementById('scan').addEventListener('click', function(){\r\n  var range = document.getElementById(\"range\").value;\r\n  var element = document.getElementById(\"scanning\");\r\n  element.classList.remove(\"d-none\");\r\n  my_dongle.at_central().then((data)=>{    \r\n    my_dongle.at_gapscan(4,false).then((dev)=>{\r\n      //convert array string to array of object with key value\r\n      const formated = dev.map((item) => {\r\n        const [ id, dev,devid,none,rssi,rssival,devname ] = item.split(' ');\r\n        return { id, dev,devid,none,rssi,rssival,devname};\r\n      });\r\n      //array list unique\r\n      let uniqueArr= formated.filter(y=>y.devname!=undefined)\r\n      //sort based on rssi value\r\n      uniqueArr.sort((a, b) => a.rssival > b.rssival && 1 || -1)\r\n      \r\n      let withDistance= uniqueArr.map(r=>{\r\n        if(getDistance(r.rssival)<=range)\r\n          r.distance=getDistance(r.rssival).toFixed(2)+' meter'\r\n        return r \r\n      }).filter(k=>{\r\n        return k.distance!==undefined\r\n      })\r\n      //generate output\r\n      let mytable = `<h2>Device List</h2>\r\n      <table class='table table-striped table-bordered'>\r\n      <tr>\r\n      <th></th>\r\n      <th>Device</th>\r\n      <th>RSSI</th>\r\n      <th>Distance</th>\r\n      </tr>`;\r\n      withDistance.map((j,index)=>{\r\n        mytable += \"<tr><td>\"+parseInt(index+1)+\"</td><td>\" +j.devid+\" - \"+ j.devname + \"</td><td>\"+ j.rssival+\"</td><td>\"+j.distance+\"</td></tr>\";\r\n      })\r\n      mytable += \"</table>\";\r\n      document.getElementById(\"deviceList\").innerHTML = mytable;\r\n      document.getElementById(\"numDev\").innerHTML = withDistance.length+' Devices Found within '+range+' meter';\r\n      element.classList.add(\"d-none\");\r\n    })\r\n  })\r\n})"],"names":[],"version":3,"file":"index.810bb8fa.js.map","sourceRoot":"/__parcel_source_root/"}